# Scriptable 天数计时组件

一个精美的 iOS 主屏幕小组件，用于显示从指定日期开始计算的天数，支持自定义标题和从截图提取颜色生成渐变背景。

## ✨ 功能特性

- 📅 **日期计时**：选择起始日期，自动计算并显示天数
- 🎨 **智能配色**：从截图提取颜色，生成符合图片色系的渐变背景
- 🌈 **Mesh Gradient 背景**：使用柔和的网格渐变效果，支持多种颜色融合
- ✏️ **自定义标题**：支持自定义标题文案，默认显示"计时第"
- 📱 **多尺寸支持**：完美适配小、中、大三种组件尺寸
- 💾 **数据持久化**：所有设置自动保存，组件刷新时自动读取

## 📋 使用要求

- iOS 设备
- [Scriptable App](https://scriptable.app/)（免费）
- iOS 14+（支持小组件功能）

## 🚀 安装步骤

1. 在 App Store 下载并安装 **Scriptable**
2. 打开 Scriptable App
3. 点击右上角 **+** 创建新脚本
4. 将 `index.js` 中的代码复制粘贴到脚本中
5. 点击右上角 **▶️** 运行脚本进行初始设置

## ⚙️ 初始设置

首次运行脚本时，会依次提示你进行以下设置：

### 1. 设置标题
- 输入自定义标题（如"计时第"）
- 或点击"使用默认"使用默认标题"计时第"
- 留空也会使用默认标题

### 2. 选择日期
- 选择起始日期（如纪念日、开始日期等）
- 组件会自动计算从该日期到今天的天数

### 3. 选择背景颜色
- **从相册选择**：选择一张图片，脚本会提取图片中的主要颜色生成渐变背景
- **使用默认配色**：使用预设的随机配色方案

## 📱 添加到桌面

1. 在 Scriptable App 中完成初始设置
2. 长按主屏幕进入编辑模式
3. 点击左上角 **+** 添加小组件
4. 搜索并选择 **Scriptable**
5. 选择你想要的组件尺寸（小/中/大）
6. 点击"添加小组件"
7. 点击组件，选择你创建的脚本

## 🎨 组件尺寸说明

### 小组件 (Small)
- 尺寸：155×155 点
- 适合：简洁显示天数

### 中组件 (Medium)
- 尺寸：329×155 点
- 适合：横向展示，信息完整

### 大组件 (Large)
- 尺寸：329×345 点
- 适合：大字体显示，视觉效果突出

## 🔧 修改设置

如果需要修改标题、日期或背景颜色：

1. 打开 Scriptable App
2. 找到并运行你的脚本
3. 按照提示重新设置即可

## 📂 数据存储

所有设置保存在 Scriptable 的本地文档目录：

- `widget-title.txt` - 自定义标题
- `widget-start-date.txt` - 起始日期
- `widget-colors.json` - 背景颜色配置

## 🎯 技术特性

- **真实颜色提取**：使用 WebView + Canvas API 从图片中提取真实像素颜色
- **颜色增强**：自动调整颜色饱和度和亮度，确保背景效果最佳
- **高分辨率渲染**：使用 3x 分辨率渲染背景，确保 Retina 屏幕清晰显示
- **自适应布局**：根据组件尺寸自动调整字体大小和间距
- **智能文字缩放**：文字支持自动缩放，确保在不同尺寸下完整显示

## 📝 自定义说明

### 修改默认标题

在代码第 6 行修改 `DEFAULT_TITLE` 常量：

```javascript
const DEFAULT_TITLE = "计时第"
```

### 修改默认配色方案

在代码第 352-358 行修改 `DEFAULT_PALETTES` 数组：

```javascript
const DEFAULT_PALETTES = [
    ["#667eea", "#764ba2", "#f093fb"],
    // 添加更多配色方案...
]
```

## 🐛 常见问题

**Q: 组件显示空白？**  
A: 确保已在 Scriptable App 中完成初始设置，包括标题、日期和背景颜色。

**Q: 背景颜色不清晰？**  
A: 选择颜色丰富、对比度较高的图片，效果会更好。

**Q: 如何重置所有设置？**  
A: 在 Scriptable App 中删除脚本，或手动删除保存的数据文件后重新运行。

**Q: 组件不自动更新？**  
A: iOS 小组件有刷新限制，可以长按组件选择"编辑小组件"来手动刷新。

## 📄 许可证

本项目仅供个人学习使用。

## 🙏 致谢

- 感谢 [Scriptable](https://scriptable.app/) 提供强大的自动化平台
- 背景生成算法参考了 Mesh Gradient 实现

---

**享受你的个性化计时组件！** ⏰✨

